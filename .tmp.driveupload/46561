'use client';

import React from "react";
import { IMaskInput } from "react-imask";
import { Input } from "@/components/ui/input";

export interface InputMaskWrapperProps
  extends React.InputHTMLAttributes<HTMLInputElement> {
  mask: string;
    value?: string;
}

/**
 * Wrapper for react-input-mask that preserves Shadcn Input styling
 * and works with Next.js + TypeScript safely.
 */
const ForwardedInput = React.forwardRef<HTMLInputElement, React.ComponentProps<typeof Input>>(
  (props, ref) => <Input {...props} ref={ref} />
);

export default function InputMaskWrapper({
  mask,
  value,
  onChange,
  ...props
}: InputMaskWrapperProps) {
  return (
    <IMaskInput
      {...props}
      mask={mask}
      value={value ?? ""}
      onAccept={(val) =>
        onChange?.({ target: { value: val } } as React.ChangeEvent<HTMLInputElement>)
      }
      as={ForwardedInput as any} // still cast to satisfy IMask types
    />
  );
}
